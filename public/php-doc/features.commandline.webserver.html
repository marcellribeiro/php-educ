<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Servidor web embutido</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="features.commandline.interactive.html">« Shell interativo</a></li>
      <li style="float: right;"><a href="features.commandline.ini.html">Configura&ccedil;&otilde;es INI »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="/">PHP-EDUC</a></li><li><a href="/php-doc/">Manual</a></li>
    <li><a href="features.commandline.html">Uso da linha de Comando</a></li>
    <li>Servidor web embutido</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="features.commandline.webserver" class="section">
  <h2 class="title">Servidor web embutido</h2>

  <div class="warning"><strong class="warning">Aviso</strong>
   <p class="para">
    Esse servidor web foi desenvolvido para auxiliar no desenvolvimento de aplicações.
    Ele também pode ser útil para testes ou para demonstrações de aplicações que forem
    executadas em ambientes controlados. Ele não foi desenvolvido para ser um web
    server completo. Ele não deve ser utilizado em uma rede pública.
   </p>
  </div>

  <p class="para">
   O <abbr title="Command Line Interpreter/Interface">CLI</abbr> <abbr title="Server Application Programming Interface">SAPI</abbr> fornece um servidor web embutido.
  </p>

  <p class="para">
   Esse servidor embutido roda apenas um processo single-thread, de forma que
   aplicações PHP irão congelar se uma requisição bloquear.
  </p>

  <p class="para">
    Requisições de URI são servidas a partir do diretório atual onde o
    PHP foi iniciado, a não ser que a opção -t seja usada para especificar
    uma raiz de documento explicitamente. Se uma requisição de URI especificar um arquivo específico
    então ou o index.php ou index.html no diretório em questão será
    retornado. Se nenhum deles existir, a procura por index.php e index.html
    continuará nos diretórios superiores até que algum deles seja encontrado
    ou o document root seja alcançado. Caso um index.php ou index.html seja encontrado
    então é retornado e $_SERVER[&#039;PATH_INFO&#039;] é configurado para a parte final
    da URI. Caso contrário uma resposta 404 é retornada.
  </p>

  <p class="para">
    Se um arquivo PHP for fornecido na linha de comando quando o servidor
    web for iniciado ele será tratado como roteador. O script é executado
    no inicio de cada requisição HTTP. Se o script retornar <strong><code>false</code></strong>,
    então o recurso requisitado será retornado da maneira como estiver.
    Do contrário, a saída do script será retornada para o navegador.
  </p>

  <p class="para">
    MIME types padrões serão retornados para arquivos com as extensões: .3gp,
    .apk, .avi, .bmp, .css, .csv, .doc, .docx, .flac, .gif, .gz,
    .gzip, .htm, .html, .ics, .jpe, .jpeg, .jpg, .js, .kml, .kmz,
    .m4a, .mov, .mp3, .mp4, .mpeg, .mpg, .odp, .ods, .odt, .oga, .ogg,
    .ogv, .pdf, .pdf, .png, .pps, .pptx, .qt, .svg, .swf, .tar, .text,
    .tif, .txt, .wav, .webm, .wmv, .xls, .xlsx, .xml, .xsl, .xsd, and .zip.
  </p>


  <table class="doctable table">
   <caption><strong>Documento de mudanças: MIME Types suportados (extensões de arquivos)</strong></caption>
   
    <thead>
     <tr>
      <th>Versão</th>
      <th>Descrição</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>5.5.12</td>
      <td>
       .xml, .xsl, and .xsd
      </td>
     </tr>

     <tr>
      <td>5.5.7</td>
      <td>
       .3gp, .apk, .avi, .bmp, .csv, .doc, .docx, .flac, .gz, .gzip,
       .ics, .kml, .kmz, .m4a, .mp3, .mp4, .mpg, .mpeg, .mov, .odp, .ods,
       .odt, .oga, .pdf, .pptx, .pps, .qt, .swf, .tar, .text, .tif, .wav,
       .wmv, .xls, .xlsx, and .zip
      </td>
     </tr>

     <tr>
      <td>5.5.5</td>
      <td>
       .pdf
      </td>
     </tr>

     <tr>
      <td>5.4.11</td>
      <td>
       .ogg, .ogv, and .webm
      </td>
     </tr>

     <tr>
      <td>5.4.4</td>
      <td>
        .htm and .svg
      </td>
     </tr>

    </tbody>
   
  </table>



  <table class="doctable table">
   <caption><strong>Changelog</strong></caption>
   
    <thead>
     <tr>
      <th>Versão</th>
      <th>Descrição</th>
     </tr>

    </thead>

    <tbody class="tbody">
     <tr>
      <td>7.4.0</td>
      <td>
       Você pode configurar o servidor web embutido para trabalhar com várias threads
       em paralelo para testar código que requeira requisições concorrentes
       ao servidor. Configure a variável de ambiente <var class="envar">PHP_CLI_SERVER_WORKERS</var>
       para o número de workers desejados antes de iniciar
       o servidor.
       Essa opção não é suportada no Windows.
       <div class="warning"><strong class="warning">Aviso</strong>
        <p class="para">
         Esse recurso é <em class="emphasis">experimental</em> e <em class="emphasis">não</em>
         é desenhado para uso em produção. O servidor web embutido
         <em class="emphasis">não</em> é desenhado para uso em produção.
        </p>
       </div>
      </td>
     </tr>

    </tbody>
   
  </table>



  <div class="example" id="example-474">
   <p><strong>Exemplo #1 Iniciando o servidor web</strong></p>
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ cd ~/public_html
$ php -S localhost:8000</pre>
</div>
   </div>

   <div class="example-contents"><p>
     O terminal irá exibir:
   </p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
PHP 5.4.0 Development Server started at Thu Jul 21 10:43:28 2011
Listening on localhost:8000
Document root is /home/me/public_html
Press Ctrl-C to quit
</pre></div>
   </div>
   <div class="example-contents"><p>
     Após serem feitas requisições de URI para for http://localhost:8000/ e
     http://localhost:8000/myscript.html o terminal irá exibir
     algo similar a:
   </p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
PHP 5.4.0 Development Server started at Thu Jul 21 10:43:28 2011
Listening on localhost:8000
Document root is /home/me/public_html
Press Ctrl-C to quit.
[Thu Jul 21 10:48:48 2011] ::1:39144 GET /favicon.ico - Request read
[Thu Jul 21 10:48:50 2011] ::1:39146 GET / - Request read
[Thu Jul 21 10:48:50 2011] ::1:39147 GET /favicon.ico - Request read
[Thu Jul 21 10:48:52 2011] ::1:39148 GET /myscript.html - Request read
[Thu Jul 21 10:48:52 2011] ::1:39149 GET /favicon.ico - Request read
</pre></div>
   </div>
   <div class="example-contents"><p>
    Note que antes do PHP 7.4.0, recursos estáticos representados por symlinks não eram
    acessíveis pelo Windows, sendo necessário um script de roteamento nesses casos.
   </p></div>
  </div>

  <div class="example" id="example-475">
   <p><strong>Exemplo #2 Iniciando o servidor web com um diretório raiz específico</strong></p>
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ cd ~/public_html
$ php -S localhost:8000 -t foo/</pre>
</div>
   </div>

   <div class="example-contents"><p>
     O terminal irá exibir:
   </p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
PHP 5.4.0 Development Server started at Thu Jul 21 10:50:26 2011
Listening on localhost:8000
Document root is /home/me/public_html/foo
Press Ctrl-C to quit
</pre></div>
   </div>
  </div>

  <div class="example" id="example-476">
   <p><strong>Exemplo #3 Usando um script de roteamento</strong></p>
<div class="example-contents"><p>
  Nesse exemplo, requisições para imagens serão exibidas, mas requisições para arquivos HTML irão exibir &quot;Welcome to PHP&quot;:
</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// router.php<br /></span><span style="color: #007700">if (</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\.(?:png|jpg|jpeg|gif)$/'</span><span style="color: #007700">, </span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REQUEST_URI"</span><span style="color: #007700">])) {<br />    return </span><span style="color: #0000BB">false</span><span style="color: #007700">;    </span><span style="color: #FF8000">// serve the requested resource as-is.<br /></span><span style="color: #007700">} else {<br />    echo </span><span style="color: #DD0000">"&lt;p&gt;Welcome to PHP&lt;/p&gt;"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ php -S localhost:8000 router.php</pre>
</div>
   </div>

  </div>

  <div class="example" id="example-477">
   <p><strong>Exemplo #4 Verificando o Uso do CLI Web Server</strong></p>
<div class="example-contents"><p>
  Para reutilizar um script de roteamento específico de um framework durante o desenvolvimento com o servidor web CLI e depois também em um servidor de produção:
</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// router.php<br /></span><span style="color: #007700">if (</span><span style="color: #0000BB">php_sapi_name</span><span style="color: #007700">() == </span><span style="color: #DD0000">'cli-server'</span><span style="color: #007700">) {<br />    </span><span style="color: #FF8000">/* route static assets and return false */<br /></span><span style="color: #007700">}<br /></span><span style="color: #FF8000">/* go on with normal index.php operations */<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ php -S localhost:8000 router.php</pre>
</div>
   </div>

  </div>

  <div class="example" id="example-478">
   <p><strong>Exemplo #5 Tratando de tipos de arquivos não suportados</strong></p>
<div class="example-contents"><p>
  Se você precisar servir um recurso estático cujo MIME type não é tratado pelo servidor web CLI, use:
</p></div>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// router.php<br /></span><span style="color: #0000BB">$path </span><span style="color: #007700">= </span><span style="color: #0000BB">pathinfo</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"SCRIPT_FILENAME"</span><span style="color: #007700">]);<br />if (</span><span style="color: #0000BB">$path</span><span style="color: #007700">[</span><span style="color: #DD0000">"extension"</span><span style="color: #007700">] == </span><span style="color: #DD0000">"el"</span><span style="color: #007700">) {<br />    </span><span style="color: #0000BB">header</span><span style="color: #007700">(</span><span style="color: #DD0000">"Content-Type: text/x-script.elisp"</span><span style="color: #007700">);<br />    </span><span style="color: #0000BB">readfile</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"SCRIPT_FILENAME"</span><span style="color: #007700">]);<br />}<br />else {<br />    return </span><span style="color: #0000BB">FALSE</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ php -S localhost:8000 router.php</pre>
</div>
   </div>

  </div>

  <div class="example" id="example-479">
   <p><strong>Exemplo #6 Acessando o servidor web CLI de máquinas remotas</strong></p>
    <div class="example-contents"><p>
     Você pode tornar o servidor web acessível na porta 8000 para qualquer interface com:
    </p></div>
   <div class="example-contents">
<div class="shellcode"><pre class="shellcode">$ php -S 0.0.0.0:8000</pre>
</div>
   </div>

   <div class="warning"><strong class="warning">Aviso</strong>
    <p class="para">
     O servidor web embutido não deve ser exposto em redes públicas.
    </p>
   </div>
  </div>

 </div></div></div></body></html>